üõ°Ô∏è D√çA 04: PAISAJE SONORO EVOLUTIVO (DSP & WEB AUDIO)
Bloque 1: Arquitectura del Motor de Audio (Audio Graph)
Contexto: Necesitamos un nodo central que gestione el flujo de sonido antes de que llegue a los altavoces, permitiendo manipulaci√≥n en tiempo real.Prompt:
"SAM, iniciamos el D√≠a 04. Vamos a construir el Motor de Audio T√°ctico.

Crea una clase AudioManager en el frontend que inicialice el AudioContext.

Implementa un Grafo de Audio que incluya: un nodo de ganancia principal (GainNode), un filtro pasabajos (BiquadFilterNode) y un nodo de distorsi√≥n (WaveShaperNode).

Configura la carga de tres capas de ambiente (assets locales o externos): 'Calma en la Comarca', 'Tensi√≥n en el Bosque' y 'Asedio de Mordor'.

Escribe un test que verifique que el AudioContext se activa correctamente tras la primera interacci√≥n del usuario (cumpliendo las pol√≠ticas de los navegadores modernos).Prioriza eficiencia de memoria para evitar clicks o glitches digitales."

Bloque 2: DSP Din√°mico y Nivel de Sombra (Audio Degradation)
Contexto: El sonido debe reaccionar a la base de datos. Si hay muchos enemigos, la m√∫sica debe "sufrir".Prompt:
"Motor de audio en l√≠nea. Ahora, vinculamos la Sombra con el Procesamiento de Se√±al (DSP).

Crea una funci√≥n sincronizarAudioConSombra(nivelSombra) que reciba el conteo total de enemigos.

Implementa la l√≥gica de degradaci√≥n:
Filtro: A mayor nivel de sombra, reduce la frequency del BiquadFilter (efecto de sonido apagado/asfixiante).
Distorsi√≥n: Incrementa el factor de curve del WaveShaper para a√±adir agresividad arm√≥nica cuando haya Uruk-hais.
Crossfade: Realiza una transici√≥n suave de volumen entre las tres capas de ambiente seg√∫n la gravedad del asedio.

Utiliza linearRampToValueAtTime para que los cambios en el audio sean fluidos y no bruscos.

Documenta t√©cnicamente el rango de frecuencias de corte para cada 'Nivel de Sombra'."

Bloque 3: Disparadores de Eventos (Sound Sprites)
Contexto: Cada acci√≥n en el Libro Rojo debe tener un impacto sonoro inmediato.Prompt:
"Audio ambiental configurado. Procedemos a los Disparadores T√°cticos.
Implementa un sistema de 'Sound Sprites' para efectos breves:
√âxito (Gesta cumplida): Una fanfarria met√°lica brillante.
Fracaso (Juicio de Gandalf): Un cuerno de guerra orco con mucha reverberaci√≥n.
Escritura: Un sonido sutil de pergamino/pluma para cuando Sam anota tareas.

Aseg√∫rate de que estos sonidos se reproduzcan en una capa independiente para no interrumpir el ambiente.

Implementa un control de volumen maestro (Master Fader) en la interfaz para que el usuario pueda silenciar el sistema si es necesario.

"Bloque 4: Templado del Motor (Testing de Audio)
Contexto: El audio es dif√≠cil de testear, pero validaremos que los par√°metros de los nodos cambian cuando deben.Prompt:
"Finalizamos el D√≠a 04 con el Control de Calidad del Paisaje Sonoro.

Escribe un test unitario con Jest que verifique que la funci√≥n sincronizarAudioConSombra modifica efectivamente los atributos value de los nodos de filtro y ganancia.

Simula una entrada de '20 enemigos' y valida que la frecuencia del filtro cae por debajo de los $500 Hz$.

Crea una rutina de limpieza (cleanup) que suspenda el AudioContext cuando el usuario cierre la sesi√≥n o cambie de pesta√±a, optimizando el uso de la CPU.Dame el c√≥digo con la elegancia t√©cnica de un DAW profesional. Tono JARVIS."
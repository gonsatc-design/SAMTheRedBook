üõ°Ô∏è D√çA 07: PROTOCOLO DE INCURSI√ìN (COOPERACI√ìN GLOBAL)

Bloque 1: El Despertar del Balrog (L√≥gica de Jefe Mundial)
Contexto: Necesitamos un enemigo com√∫n cuyo HP dependa de las acciones de todos los usuarios registrados.
Prompt:"SAM, iniciamos el D√≠a 07. Necesito activar el Protocolo de Incursi√≥n.Crea una funci√≥n en el servidor procesarDanioGlobal() que se ejecute cada vez que cualquier usuario complete una tarea.La l√≥gica debe restar HP a la tabla world_events:$$HP_{final} = HP_{actual} - (Dificultad_{tarea} \times Multiplicador_{clase})$$Implementa un sistema de 'Estados de Furia': si el HP baja del 50%, el multiplicador de generaci√≥n de orcos para todos los usuarios aumenta un 1.5x (el jefe se defiende).Escribe un Test de Integraci√≥n que simule a 5 usuarios completando tareas simult√°neamente y verifique que el HP de Sauron/Balrog en la base de datos se reduce de forma consistente sin condiciones de carrera (race conditions).

"Bloque 2: El Sacrificio de Isildur (Mec√°nica de Gasto Heroico)Contexto: Permitir que los usuarios m√°s avanzados ayuden a los novatos o a la comunidad gastando su propio progreso.Prompt:"L√≥gica de da√±o base lista. Ahora, implementamos la Mec√°nica de Sacrificio.Crea una ruta POST /api/raid/sacrifice que permita a un usuario gastar una cantidad de su XP u Oro personal para realizar un 'Ataque Cr√≠tico' al jefe mundial.Este ataque debe reducir el HP del jefe significativamente y, a cambio, otorgar al usuario un 'Logro de H√©roe' en su perfil.Implementa una validaci√≥n t√©cnica: un usuario no puede sacrificar XP si esto le hace bajar de nivel (protecci√≥n de progresi√≥n).Dise√±a el test para verificar que, tras el sacrificio, los fondos del usuario disminuyen y el HP global cae seg√∫n la equivalencia definida."

Bloque 3: HUD de Guerra (Visualizaci√≥n de Incursi√≥n)Contexto: El usuario debe sentir la urgencia del combate global desde la interfaz principal.Prompt:"Mec√°nicas de backend operativas. Ahora, a por la Interfaz de Incursi√≥n.Dise√±a un widget de 'Evento Activo' en el index.html que muestre un sprite del Balrog y una barra de HP masiva.Usa CSS Animations para que la barra de vida tiemble (shake) y emita part√≠culas de fuego cada vez que el HP baje de un umbral espec√≠fico.Implementa un 'Feed de Batalla' en tiempo real (usando Supabase Realtime o long polling) que muestre mensajes tipo: '¬°Elfo_77 ha infligido 500 de da√±o!'A√±ade un temporizador de cuenta atr√°s: si el jefe no es derrotado antes de 24h, lanza un evento de 'Debuff Global' (ej: -20% de ganancia de oro para todos)."

Bloque 4: Templado de Red y Sincron√≠aContexto: Asegurar que el sistema aguanta la carga de m√∫ltiples usuarios golpeando al mismo tiempo.Prompt:"Finalizamos el D√≠a 07 con el Test de Estr√©s de la Incursi√≥n.Escribe un script de test que use Promise.all para disparar 50 peticiones de da√±o al servidor en menos de 1 segundo.Valida que la base de datos gestiona las transacciones correctamente y el HP final es exacto.Implementa una l√≥gica de 'Recompensa de Victoria': si el HP llega a 0, todos los usuarios que participaron reciben autom√°ticamente 3 materiales raros en su inventario.Documenta el flujo de datos desde el clic del usuario hasta la actualizaci√≥n del HP global en el Dashboard. Tono JARVIS."